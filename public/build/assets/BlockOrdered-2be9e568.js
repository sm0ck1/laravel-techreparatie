import{j as e,y as T,r as i}from"./app-8bfa598a.js";import{d as A,a as y}from"./Check-44f72559.js";import{M as W}from"./Modal-4342cdca.js";import E from"./ConfirmDialog-16042b20.js";import{u as P,r as R}from"./repairStore-a1a24db1.js";import{r as q,i as L}from"./createSvgIcon-fcfa2ec4.js";import{d as $}from"./LocalShipping-03fb8298.js";import{u as U}from"./useMutation-e596a6e6.js";import{B as d}from"./Box-c3bcb5bf.js";import{T as m,F as V,I as H,S as N}from"./TextField-72c6bf8f.js";import{A as G}from"./Autocomplete-97149aba.js";import{M as S}from"./MenuItem-a01d4143.js";import{L as C}from"./LoadingButton-c952b147.js";import{B as J}from"./Button-f80121a0.js";import"./Modal-b84eed1f.js";import"./createTheme-428a024d.js";import"./styled-9a5592bd.js";import"./generateUtilityClasses-e7b23a81.js";import"./TransitionGroupContext-5e7c6940.js";import"./useId-10c2ae54.js";import"./Container-b34a53b0.js";import"./styled-15713ffe.js";import"./Typography-696c5318.js";import"./extendSxProp-d41d6d52.js";import"./ButtonBase-5a468970.js";import"./vanilla-8854675d.js";import"./createSvgIcon-720c9648.js";import"./isMuiElement-17093264.js";import"./Menu-6587255b.js";import"./IconButton-9ae7adef.js";import"./dividerClasses-91e3d1a1.js";var p={},K=L;Object.defineProperty(p,"__esModule",{value:!0});var b=p.default=void 0,Q=K(q()),X=e,Y=(0,Q.default)((0,X.jsx)("path",{d:"M16 1a7 7 0 0 0-5.78 3.05l.02-.03C9.84 4 9.42 4 9 4c-4.42 0-8 .5-8 4v10c0 .88.39 1.67 1 2.22V22a1 1 0 0 0 1 1h1a1 1 0 0 0 1-1v-1h8v1a1 1 0 0 0 1 1h1a1 1 0 0 0 1-1v-1.78c.61-.55 1-1.34 1-2.22v-3.08A7 7 0 0 0 16 1zM4.5 19a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zM3 13V8h6c0 1.96.81 3.73 2.11 5H3zm10.5 6a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm2.5-6a5 5 0 1 1 0-10 5 5 0 0 1 0 10zm-1-9h2v5h-2zm0 6h2v2h-2z"}),"BusAlert");b=p.default=Y;const Z=()=>U({mutationFn:async({id:r,props:n})=>{try{const{data:a}=await axios.patch(route("repairs.update.ordered",r),n);return Promise.resolve(a)}catch(a){return Promise.reject(a.response.data.errors)}},onSuccess:()=>{T.reload({only:["repairs"]})}}),Be=({repair:r})=>{const n="is_ordered_component",a=P(R),u=a.employees,M=a.groupWhereOrdered,[I,h]=i.useState(!1),[O,f]=i.useState(!1),[k,c]=i.useState(!1),[s,l]=i.useState({who_ordered_id:0,component:r.component,is_ordered_component:!1,cost:void 0,where_ordered:""}),{mutate:x,isPending:_,error:o,isSuccess:v}=Z();i.useEffect(()=>{h(!!r[n])},[]),i.useEffect(()=>{v&&(c(!1),h(!I))},[v]);const z=async t=>{r[n]?f(!0):c(!0)},B=async()=>{x({id:r.id,props:{[n]:!1,who_ordered_id:0,component:"",cost:0,is_ordered_component:!1}})},j=()=>{c(!1)},F=async()=>{x({id:r.id,props:{...s,[n]:!0}})},g=()=>r.is_fixed&&r.who_ordered_id>0?1:r.who_ordered_id>0&&r.is_ordered_component&&!r.is_fixed?2:r.is_fixed&&!r.who_ordered_id?3:4,D=()=>{const t=g();return t===1?e.jsx(d,{sx:{display:"flex",flexDirection:"column",gap:1,alignItems:"center"},children:e.jsx(A,{})}):t===2?e.jsxs(d,{"aria-describedby":"block-ordered-status-open-popover",sx:{display:"flex",flexDirection:"column",gap:1,alignItems:"center"},children:[e.jsx($,{}),r.date_ordered]}):t===3?e.jsx(e.Fragment,{children:e.jsx(y,{})}):r.component&&r.is_ordered_component===0?e.jsx(b,{}):e.jsx(y,{})};return e.jsxs(e.Fragment,{children:[e.jsx(W,{open:k,onClose:j,title:"Ordered",children:e.jsxs(d,{sx:{display:"flex",gap:5,flexDirection:"column"},children:[e.jsx(d,{children:e.jsx(m,{value:s.component||"",onChange:t=>l({...s,component:t.target.value}),sx:{width:"100%"},id:"component",label:"Need to order",error:!!(o!=null&&o.component),helperText:o==null?void 0:o.component,variant:"outlined"})}),e.jsx(d,{children:e.jsx(m,{value:s.cost||"",type:"number",min:0,onChange:t=>l({...s,cost:t.target.value}),sx:{width:"100%"},id:"cost",label:"Cost",error:!!(o!=null&&o.cost),helperText:o==null?void 0:o.cost,variant:"outlined"})}),e.jsx(d,{children:e.jsx(G,{id:"where_ordered",freeSolo:!0,options:M.map(t=>t.where_ordered),onInputChange:(t,w)=>{l({...s,where_ordered:w})},renderInput:t=>e.jsx(m,{error:!!(o!=null&&o.where_ordered),helperText:o==null?void 0:o.where_ordered,value:s.where_ordered||"",...t,label:"Where ordered"})})}),u.length&&e.jsxs(V,{fullWidth:!0,children:[e.jsx(H,{id:"demo-simple-select-label",children:"Who ordered?"}),e.jsxs(N,{labelId:"demo-simple-select-label",id:"who_ordered",value:s.who_ordered_id||0,label:"Who ordered?",error:!!(o!=null&&o.who_ordered_id),helperText:o==null?void 0:o.who_ordered_id,onChange:t=>l({...s,who_ordered_id:t.target.value}),children:[e.jsx(S,{disabled:!0,value:0,children:"Set employee"}),u.map((t,w)=>e.jsx(S,{value:t.id,children:t.name},t.id))]})]}),e.jsxs(d,{sx:{display:"flex",gap:3,justifyContent:"space-between"},children:[e.jsx(d,{sx:{display:"flex",gap:3},children:e.jsx(C,{color:"success",disabled:!s.who_ordered_id,loading:_,variant:"contained",onClick:F,children:"Save"})}),e.jsx(d,{children:e.jsx(J,{variant:"contained",color:"primary",onClick:j,children:"Cancel"})})]})]})}),e.jsx(E,{title:"Unmarked Picked Up?",open:O,setOpen:f,onConfirm:B,children:"Are you sure? It will be unmarked as picked up."}),e.jsx(C,{loading:_,color:g()!==4?"success":"error",size:"small",variant:"text",onClick:z,children:D()})]})};export{Be as default};
