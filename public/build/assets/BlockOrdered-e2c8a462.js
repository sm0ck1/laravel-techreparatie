import{j as e,y as T,r as i}from"./app-f1c828f7.js";import{d as A,a as y}from"./Check-09186f61.js";import{M as W}from"./Modal-a9b3aa1d.js";import E from"./ConfirmDialog-dc49bdec.js";import{u as P,r as R}from"./repairStore-fcbf1ff6.js";import{r as q,i as L}from"./createSvgIcon-5ef262e0.js";import{d as $}from"./LocalShipping-aa39704a.js";import{u as U}from"./useMutation-ac1b88b9.js";import{B as d}from"./Box-f07d3107.js";import{T as m,F as V,I as H,S as N}from"./TextField-786e87d4.js";import{A as G}from"./Autocomplete-281851cf.js";import{M as S}from"./MenuItem-1ee02e2c.js";import{L as C}from"./LoadingButton-46b470b3.js";import{B as J}from"./Button-d62b349f.js";import"./Modal-52c5d07f.js";import"./createTheme-41447446.js";import"./styled-3cd3900f.js";import"./TransitionGroupContext-4c204ff9.js";import"./useId-c9e8e77e.js";import"./Container-6b860eac.js";import"./styled-aff25966.js";import"./Typography-aadd2b68.js";import"./extendSxProp-af694d93.js";import"./ButtonBase-8b99eabd.js";import"./vanilla-8854675d.js";import"./createSvgIcon-636eeff5.js";import"./Menu-9bd5f357.js";import"./IconButton-5bb73f7e.js";import"./dividerClasses-912e16fb.js";var u={},K=L;Object.defineProperty(u,"__esModule",{value:!0});var b=u.default=void 0,Q=K(q()),X=e,Y=(0,Q.default)((0,X.jsx)("path",{d:"M16 1a7 7 0 0 0-5.78 3.05l.02-.03C9.84 4 9.42 4 9 4c-4.42 0-8 .5-8 4v10c0 .88.39 1.67 1 2.22V22a1 1 0 0 0 1 1h1a1 1 0 0 0 1-1v-1h8v1a1 1 0 0 0 1 1h1a1 1 0 0 0 1-1v-1.78c.61-.55 1-1.34 1-2.22v-3.08A7 7 0 0 0 16 1zM4.5 19a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zM3 13V8h6c0 1.96.81 3.73 2.11 5H3zm10.5 6a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm2.5-6a5 5 0 1 1 0-10 5 5 0 0 1 0 10zm-1-9h2v5h-2zm0 6h2v2h-2z"}),"BusAlert");b=u.default=Y;const Z=()=>U({mutationFn:async({id:r,props:n})=>{try{const{data:a}=await axios.patch(route("repairs.update.ordered",r),n);return Promise.resolve(a)}catch(a){return Promise.reject(a.response.data.errors)}},onSuccess:()=>{T.reload({only:["repairs"]})}}),Ie=({repair:r})=>{const n="is_ordered_component",a=P(R),p=a.employees,M=a.groupWhereOrdered,[O,h]=i.useState(!1),[k,f]=i.useState(!1),[I,c]=i.useState(!1),[s,l]=i.useState({who_ordered_id:0,component:r.component,is_ordered_component:!1,cost:void 0,where_ordered:""}),{mutate:x,isPending:_,error:o,isSuccess:v}=Z();i.useEffect(()=>{h(!!r[n])},[]),i.useEffect(()=>{v&&(c(!1),h(!O))},[v]);const z=async t=>{r[n]?f(!0):c(!0)},B=async()=>{x({id:r.id,props:{[n]:!1,who_ordered_id:0,component:"",cost:0,is_ordered_component:!1}})},j=()=>{c(!1)},F=async()=>{x({id:r.id,props:{...s,[n]:!0}})},g=()=>r.is_fixed&&r.who_ordered_id>0?1:r.who_ordered_id>0&&r.is_ordered_component&&!r.is_fixed?2:r.is_fixed&&!r.who_ordered_id?3:4,D=()=>{const t=g();return t===1?e.jsx(d,{sx:{display:"flex",flexDirection:"column",gap:1,alignItems:"center"},children:e.jsx(A,{})}):t===2?e.jsxs(d,{"aria-describedby":"block-ordered-status-open-popover",sx:{display:"flex",flexDirection:"column",gap:1,alignItems:"center"},children:[e.jsx($,{}),r.date_ordered]}):t===3?e.jsx(e.Fragment,{children:e.jsx(y,{})}):r.component&&r.is_ordered_component===0?e.jsx(b,{}):e.jsx(y,{})};return e.jsxs(e.Fragment,{children:[e.jsx(W,{open:I,onClose:j,title:"Ordered",children:e.jsxs(d,{sx:{display:"flex",gap:5,flexDirection:"column"},children:[e.jsx(d,{children:e.jsx(m,{value:s.component||"",onChange:t=>l({...s,component:t.target.value}),sx:{width:"100%"},id:"component",label:"Need to order",error:!!(o!=null&&o.component),helperText:o==null?void 0:o.component,variant:"outlined"})}),e.jsx(d,{children:e.jsx(m,{value:s.cost||"",type:"number",min:0,onChange:t=>l({...s,cost:t.target.value}),sx:{width:"100%"},id:"cost",label:"Cost",error:!!(o!=null&&o.cost),helperText:o==null?void 0:o.cost,variant:"outlined"})}),e.jsx(d,{children:e.jsx(G,{id:"where_ordered",freeSolo:!0,options:M.map(t=>t.where_ordered),renderInput:t=>e.jsx(m,{error:!!(o!=null&&o.where_ordered),helperText:o==null?void 0:o.where_ordered,value:s.where_ordered||"",onChange:w=>l({...s,where_ordered:w.target.value}),...t,label:"Where ordered"})})}),p.length&&e.jsxs(V,{fullWidth:!0,children:[e.jsx(H,{id:"demo-simple-select-label",children:"Who ordered?"}),e.jsxs(N,{labelId:"demo-simple-select-label",id:"who_ordered",value:s.who_ordered_id||0,label:"Who ordered?",error:!!(o!=null&&o.who_ordered_id),helperText:o==null?void 0:o.who_ordered_id,onChange:t=>l({...s,who_ordered_id:t.target.value}),children:[e.jsx(S,{disabled:!0,value:0,children:"Set employee"}),p.map((t,w)=>e.jsx(S,{value:t.id,children:t.name},t.id))]})]}),e.jsxs(d,{sx:{display:"flex",gap:3,justifyContent:"space-between"},children:[e.jsx(d,{sx:{display:"flex",gap:3},children:e.jsx(C,{color:"success",disabled:!s.who_ordered_id,loading:_,variant:"contained",onClick:F,children:"Save"})}),e.jsx(d,{children:e.jsx(J,{variant:"contained",color:"primary",onClick:j,children:"Cancel"})})]})]})}),e.jsx(E,{title:"Unmarked Picked Up?",open:k,setOpen:f,onConfirm:B,children:"Are you sure? It will be unmarked as picked up."}),e.jsx(C,{loading:_,color:g()!==4?"success":"error",size:"small",variant:"text",onClick:z,children:D()})]})};export{Ie as default};
