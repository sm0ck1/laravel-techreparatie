import{r as l,j as e,y as B}from"./app-3202f596.js";import{d as D,a as v}from"./Check-798d69d4.js";import{M as W}from"./Modal-e122baf5.js";import E from"./ConfirmDialog-56d74f25.js";import{u as P,r as L}from"./repairStore-b76ed4db.js";import{d as R}from"./LocalShipping-d2d6695e.js";import{u as U}from"./useMutation-fe1021bb.js";import{B as n}from"./Box-132a8830.js";import{T as m,F as $,I as z,S as N}from"./TextField-94f03ebe.js";import{_ as Y}from"./createTheme-e443a688.js";import{A as q}from"./Autocomplete-e729db2b.js";import{M as y}from"./MenuItem-46852476.js";import{L as b}from"./LoadingButton-f9168bcf.js";import{B as G}from"./Button-69efd48b.js";import"./createSvgIcon-5ec9d790.js";import"./createSvgIcon-74e13a21.js";import"./styled-6ddd3ae9.js";import"./useId-95af0284.js";import"./TransitionGroupContext-bf46694f.js";import"./ButtonBase-bd429d2a.js";import"./Modal-012e7dea.js";import"./Container-acfea48f.js";import"./styled-6f8de2aa.js";import"./Typography-58006bdd.js";import"./extendSxProp-5b301ce9.js";import"./vanilla-8854675d.js";import"./Menu-f2ff0f34.js";import"./IconButton-86d070ce.js";import"./Popper-2c55403e.js";import"./dividerClasses-46d6c7a3.js";let S=!1;const H=l.forwardRef(function(d,i){return S||(console.warn(["MUI: The Autocomplete component was moved from the lab to the core.","","You should use `import { Autocomplete } from '@mui/material'`","or `import Autocomplete from '@mui/material/Autocomplete'`"].join(`
`)),S=!0),e.jsx(q,Y({ref:i},d))}),J=()=>U({mutationFn:async({id:r,props:d})=>{try{const{data:i}=await axios.patch(route("repairs.update.ordered",r),d);return Promise.resolve(i)}catch(i){return Promise.reject(i.response.data.errors)}},onSuccess:()=>{B.reload({only:["repairs"]})}}),Ce=({repair:r})=>{const d="is_ordered_component",i=P(L),p=i.employees,C=i.groupWhereOrdered,[O,u]=l.useState(!1),[k,f]=l.useState(!1),[M,c]=l.useState(!1),[s,a]=l.useState({who_ordered_id:0,component:"",is_ordered_component:!1,cost:void 0,where_ordered:""}),{mutate:h,isPending:x,error:o,isSuccess:_}=J();l.useEffect(()=>{u(!!r[d])},[]),l.useEffect(()=>{_&&(c(!1),u(!O))},[_]);const A=async t=>{r[d]?f(!0):c(!0)},I=async()=>{h({id:r.id,props:{[d]:!1,who_ordered_id:0,component:"",cost:0,is_ordered_component:!1}})},j=()=>{c(!1)},F=async()=>{h({id:r.id,props:{...s,[d]:!0}})},g=()=>r.is_fixed&&r.who_ordered_id>0?1:r.who_ordered_id>0&&r.is_ordered_component&&!r.is_fixed?2:r.is_fixed&&!r.who_ordered_id?3:4,T=()=>{const t=g();return t===1?e.jsx(n,{sx:{display:"flex",flexDirection:"column",gap:1,alignItems:"center"},children:e.jsx(D,{})}):t===2?e.jsxs(n,{"aria-describedby":"block-ordered-status-open-popover",sx:{display:"flex",flexDirection:"column",gap:1,alignItems:"center"},children:[e.jsx(R,{}),r.date_ordered]}):t===3?e.jsx(e.Fragment,{children:e.jsx(v,{})}):e.jsx(v,{})};return e.jsxs(e.Fragment,{children:[e.jsx(W,{open:M,onClose:j,title:"Ordered",children:e.jsxs(n,{sx:{display:"flex",gap:5,flexDirection:"column"},children:[e.jsx(n,{children:e.jsx(m,{value:s.component||"",onChange:t=>a({...s,component:t.target.value}),sx:{width:"100%"},id:"outlined-basic",label:"Need to order",error:!!(o!=null&&o.component),helperText:o==null?void 0:o.component,variant:"outlined"})}),e.jsx(n,{children:e.jsx(m,{value:s.cost||"",type:"number",min:0,onChange:t=>a({...s,cost:t.target.value}),sx:{width:"100%"},id:"outlined-basic",label:"Cost",error:!!(o!=null&&o.cost),helperText:o==null?void 0:o.cost,variant:"outlined"})}),e.jsx(n,{children:e.jsx(H,{id:"free-solo-demo",freeSolo:!0,options:C.map(t=>t.where_ordered),renderInput:t=>e.jsx(m,{error:!!(o!=null&&o.where_ordered),helperText:o==null?void 0:o.where_ordered,value:s.where_ordered||"",onChange:w=>a({...s,where_ordered:w.target.value}),...t,label:"Where ordered"})})}),p.length&&e.jsxs($,{fullWidth:!0,children:[e.jsx(z,{id:"demo-simple-select-label",children:"Who ordered?"}),e.jsxs(N,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:s.who_ordered_id||0,label:"Who ordered?",error:!!(o!=null&&o.who_ordered_id),helperText:o==null?void 0:o.who_ordered_id,onChange:t=>a({...s,who_ordered_id:t.target.value}),children:[e.jsx(y,{disabled:!0,value:0,children:"Set employee"}),p.map((t,w)=>e.jsx(y,{value:t.id,children:t.name},t.id))]})]}),e.jsxs(n,{sx:{display:"flex",gap:3,justifyContent:"space-between"},children:[e.jsx(n,{sx:{display:"flex",gap:3},children:e.jsx(b,{color:"success",disabled:!s.who_ordered_id,loading:x,variant:"contained",onClick:F,children:"Save"})}),e.jsx(n,{children:e.jsx(G,{variant:"contained",color:"primary",onClick:j,children:"Cancel"})})]})]})}),e.jsx(E,{title:"Unmarked Picked Up?",open:k,setOpen:f,onConfirm:I,children:"Are you sure? It will be unmarked as picked up."}),e.jsx(b,{loading:x,color:g()!==4?"success":"error",size:"small",variant:"text",onClick:A,children:T()})]})};export{Ce as default};
