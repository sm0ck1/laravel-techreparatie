import{y as g,r as p,j as i}from"./app-2d73ea55.js";import{M as _}from"./Modal-759e09ca.js";import{e as u}from"./editStore-d065645d.js";import s from"./BlockDivider-1f99c70e.js";import{u as h,r as C}from"./repairStore-4e972204.js";import{u as W}from"./useMutation-463f253a.js";import{T as n,F as S,I as T,S as y}from"./TextField-fd9bad2e.js";import{A as D}from"./Autocomplete-69be9359.js";import{M as E}from"./MenuItem-93a2108f.js";import{B as M}from"./Box-0aebc8bf.js";import{L as I}from"./LoadingButton-a5f2cb57.js";import{B as v}from"./Button-44ae99c3.js";import"./Modal-75514fbd.js";import"./createTheme-156a7933.js";import"./styled-da10e864.js";import"./TransitionGroupContext-391a7c7f.js";import"./useId-f0ba7148.js";import"./Container-b6fa0376.js";import"./styled-423efc69.js";import"./Typography-6359d7c6.js";import"./extendSxProp-73dc8921.js";import"./vanilla-8854675d.js";import"./createSvgIcon-fb97631e.js";import"./Menu-0f06de44.js";import"./IconButton-93defd9c.js";import"./ButtonBase-da9039f2.js";import"./Popper-67470bd8.js";import"./dividerClasses-ae5404e9.js";const P=()=>W({mutationFn:async({id:a,props:r})=>{try{const{data:c}=await axios.patch(route("repairs.update",a),r);return Promise.resolve(c)}catch(c){return Promise.reject(c.response.data.errors)}},onSuccess:()=>{g.reload({only:["repairs"]})}}),ne=()=>{const a=h(u),r=h(C),c=r.employees,x=r.groupDevices,[o,l]=p.useState({customer_name:"",customer_phone:"",device:"",problem_description:"",component:"",solution_description:"",price:"",cost:"",invoice:"",note:"",user_id:0}),{mutate:f,isPending:b,error:e,isSuccess:m}=P();p.useEffect(()=>{m&&u.clear()},[m]),p.useEffect(()=>{if(a.edit&&a.data){const t=[];Object.keys(o).map(d=>{a.data[d]&&(t[d]=a.data[d])}),l(t)}},[a.edit]);const j=async()=>{f({id:a.data.id,props:o})};return i.jsxs(_,{open:a.edit,onClose:()=>u.clear(),width:"md",title:`Edit #${a.data.id??0}`,children:[i.jsxs(s,{title:"Customer",children:[i.jsx(n,{value:o.customer_name||"",onChange:t=>l({...o,customer_name:t.target.value}),fullWidth:!0,id:"outlined-basic",label:"Name",error:!!(e!=null&&e.customer_name),helperText:e==null?void 0:e.customer_name,variant:"outlined"}),i.jsx(n,{value:o.customer_phone||"",onChange:t=>l({...o,customer_phone:t.target.value}),fullWidth:!0,id:"outlined-basic",label:"Phone",error:!!(e!=null&&e.customer_phone),helperText:e==null?void 0:e.customer_phone,variant:"outlined"})]}),i.jsxs(s,{title:"Device",children:[i.jsx(D,{id:"free-solo-demo",fullWidth:!0,freeSolo:!0,value:o.device||"",options:x.map(t=>t.device),renderInput:t=>i.jsx(n,{error:!!(e!=null&&e.device),helperText:e==null?void 0:e.device,value:o.device||"",onChange:d=>l({...o,device:d.target.value}),...t,label:"Device"})}),i.jsx(n,{value:o.problem_description||"",onChange:t=>l({...o,problem_description:t.target.value}),fullWidth:!0,id:"outlined-basic",label:"Problem description",error:!!(e!=null&&e.problem_description),helperText:e==null?void 0:e.problem_description,variant:"outlined"})]}),i.jsx(s,{title:"Need to order",other:{flexDirection:"column"},children:i.jsx(n,{value:o.component||"",onChange:t=>l({...o,component:t.target.value}),fullWidth:!0,id:"outlined-basic",label:"Parts",error:!!(e!=null&&e.component),helperText:e==null?void 0:e.component,variant:"outlined"})}),i.jsx(s,{title:"Result of repair",other:{flexDirection:"column"},children:i.jsx(n,{value:o.solution_description||"",onChange:t=>l({...o,solution_description:t.target.value}),fullWidth:!0,id:"outlined-basic",label:"Description",error:!!(e!=null&&e.solution_description),helperText:e==null?void 0:e.solution_description,variant:"outlined"})}),i.jsxs(s,{title:"Invoice",children:[i.jsx(n,{value:o.price||"",onChange:t=>l({...o,price:t.target.value}),fullWidth:!0,id:"outlined-basic",label:"Price",error:!!(e!=null&&e.price),helperText:e==null?void 0:e.price,variant:"outlined"}),i.jsx(n,{value:o.cost||"",onChange:t=>l({...o,cost:t.target.value}),fullWidth:!0,id:"outlined-basic",label:"Cost",error:!!(e!=null&&e.cost),helperText:e==null?void 0:e.cost,variant:"outlined"}),i.jsx(n,{value:o.invoice||"",onChange:t=>l({...o,invoice:t.target.value}),fullWidth:!0,id:"outlined-basic",label:"Invoice",error:!!(e!=null&&e.invoice),helperText:e==null?void 0:e.invoice,variant:"outlined"})]}),c.length&&i.jsx(s,{title:"Employeer",children:i.jsxs(S,{fullWidth:!0,children:[i.jsx(T,{id:"demo-simple-select-label",children:"Employee"}),i.jsx(y,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:o.user_id||"",label:"Employee",onChange:t=>l({...o,user_id:t.target.value}),children:c.map(t=>i.jsx(E,{value:t.id,children:t.name},t.id))})]})}),i.jsx(s,{title:"Note",children:i.jsx(n,{value:o.note||"",onChange:t=>l({...o,note:t.target.value}),fullWidth:!0,id:"outlined-basic",label:"Note",error:!!(e!=null&&e.note),helperText:e==null?void 0:e.note,variant:"outlined"})}),i.jsxs(M,{sx:{display:"flex",gap:5,flexDirection:"row"},children:[i.jsx(I,{fullWidth:!0,size:"large",color:"success",loading:b,variant:"contained",onClick:j,children:"Save"}),i.jsx(v,{fullWidth:!0,variant:"contained",onClick:u.clear,children:"Cancel"}),i.jsx(v,{fullWidth:!0,variant:"contained",color:"error",onClick:u.clear,children:"Delete"})]})]})};export{ne as default};
