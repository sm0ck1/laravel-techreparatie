import{y as w,r as l,j as e}from"./app-a04bbed2.js";import{d as B,a as E}from"./Check-8e69b07b.js";import I from"./ConfirmDialog-c17414c4.js";import{h as P}from"./repairPatch-adebb806.js";import{M as O}from"./Modal-58d08232.js";import{u as T,r as D}from"./repairStore-de3b468a.js";import{u as R}from"./useMutation-bb265620.js";import{B as a}from"./Box-3fd40cc8.js";import{T as g,F as L,I as U,S as z}from"./TextField-42cf80b5.js";import{M as v}from"./MenuItem-40342252.js";import{L as S}from"./LoadingButton-3147c087.js";import{B as A}from"./Button-7abc6489.js";import"./createSvgIcon-9a7a4a4d.js";import"./createSvgIcon-45990ec8.js";import"./createTheme-6d13dc8e.js";import"./styled-5d21694d.js";import"./TransitionGroupContext-d26061e7.js";import"./ButtonBase-f7e0d420.js";import"./Modal-3a668b68.js";import"./Typography-77cf11c3.js";import"./extendSxProp-ace8c235.js";import"./Container-7316657f.js";import"./styled-29c99bf0.js";import"./vanilla-8854675d.js";import"./Menu-2e5a6ace.js";import"./dividerClasses-52288808.js";const W=()=>R({mutationFn:async({id:o,props:n})=>{try{const{data:r}=await axios.patch(route("repairs.update.fixed",o),n);return Promise.resolve(r)}catch(r){return Promise.reject(r.response.data.errors)}},onSuccess:()=>{w.reload({only:["repairs"]})}}),fe=({repair:o})=>{var y;const n="is_fixed",u=T(D).employees,[i,d]=l.useState({user_id:0,price:0,solution_description:"",is_fixed:!0}),{mutate:_,isPending:m,isSuccess:x,error:s}=W(),[c,f]=l.useState(!1),[b,h]=l.useState(!1),[C,p]=l.useState(!1);l.useEffect(()=>{f(!!o[n])},[]),l.useEffect(()=>{x&&(p(!1),f(!c))},[x]);const F=async()=>{o[n]?h(!0):p(!0)},k=async()=>{await P(o,{[n]:!1,solution_description:""})},j=()=>{p(!1)},M=async()=>{_({id:o.id,props:{...i,[n]:!0}})};return e.jsxs(e.Fragment,{children:[e.jsx(O,{open:C,onClose:j,title:"Fixed",children:e.jsxs(a,{sx:{display:"flex",gap:5,flexDirection:"column"},children:[e.jsx(a,{children:e.jsx(g,{value:i.solution_description,onChange:t=>d({...i,solution_description:t.target.value}),sx:{width:"100%"},id:"outlined-basic",label:"Result of repair",error:!!(s!=null&&s.solution_description),helperText:s==null?void 0:s.solution_description,variant:"outlined"})}),e.jsx(a,{children:e.jsx(g,{value:i.price,type:"number",min:0,error:!!(s!=null&&s.price),helperText:s==null?void 0:s.price,onChange:t=>d({...i,price:t.target.value}),sx:{width:"100%"},id:"outlined-basic",label:"Price",variant:"outlined"})}),u.length&&e.jsxs(L,{fullWidth:!0,children:[e.jsx(U,{id:"demo-simple-select-label",children:"Employee"}),e.jsxs(z,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:i.user_id||0,label:"Employee",error:!!(s!=null&&s.user_id),helperText:s==null?void 0:s.user_id,onChange:t=>d({...i,user_id:t.target.value}),children:[e.jsx(v,{disabled:!0,value:0,children:"Set employee"}),u.map((t,$)=>e.jsx(v,{value:t.id,children:t.name},t.id))]})]}),e.jsxs(a,{sx:{display:"flex",gap:3,justifyContent:"space-between"},children:[e.jsx(a,{sx:{display:"flex",gap:3},children:e.jsx(S,{color:"success",disabled:!i.user_id,loading:m,variant:"contained",onClick:M,children:"Save"})}),e.jsx(a,{children:e.jsx(A,{variant:"contained",color:"primary",onClick:j,children:"Cancel"})})]})]})}),e.jsx(I,{title:"Unmarked Picked Up?",open:b,setOpen:h,onConfirm:k,children:"Are you sure? It will be unmarked as picked up."}),e.jsx(S,{loading:m,color:c?"success":"error",size:"small",variant:"text",onClick:F,children:c?e.jsxs(a,{sx:{display:"flex",flexDirection:"column",gap:1,alignItems:"center"},children:[e.jsx(B,{})," ",(y=o.user)==null?void 0:y.name]}):e.jsx(E,{})})]})};export{fe as default};
