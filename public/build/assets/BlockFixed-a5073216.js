import{y as _,r,j as e}from"./app-f2abb593.js";import{d as B,a as E}from"./Check-22627135.js";import I from"./ConfirmDialog-44a7c47e.js";import{M as P}from"./Modal-5dae7573.js";import{u as O,r as T}from"./repairStore-14727e7a.js";import{u as D}from"./useMutation-202674fd.js";import{B as n}from"./Box-0b011bc2.js";import{T as g,F as R,I as L,S as U}from"./TextField-b31a34e4.js";import{M as v}from"./MenuItem-fb7cf1cf.js";import{L as S}from"./LoadingButton-3ee33953.js";import{B as z}from"./Button-cd0730f4.js";import"./createSvgIcon-1d31149c.js";import"./createSvgIcon-59ac1e7b.js";import"./createTheme-f9f94404.js";import"./styled-3a987103.js";import"./useId-edbf73a4.js";import"./TransitionGroupContext-63f58615.js";import"./ButtonBase-032a6a52.js";import"./Modal-33f51ea5.js";import"./Typography-d8ebb2f5.js";import"./extendSxProp-2a5070d5.js";import"./Container-f970a168.js";import"./styled-a73ca20e.js";import"./vanilla-8854675d.js";import"./Menu-c9be6819.js";import"./dividerClasses-9ca8f8f6.js";const A=async(t,o,l="repairs.update")=>{const d=await axios.patch(route(l,{repair:t.id}),o);return d.status===200&&_.reload({only:["repairs"]}),d},W=()=>D({mutationFn:async({id:t,props:o})=>{try{const{data:l}=await axios.patch(route("repairs.update.fixed",t),o);return Promise.resolve(l)}catch(l){return Promise.reject(l.response.data.errors)}},onSuccess:()=>{_.reload({only:["repairs"]})}}),fe=({repair:t})=>{var y;const o="is_fixed",d=O(T).employees,[a,c]=r.useState({user_id:0,price:void 0,solution_description:"",is_fixed:!0}),{mutate:b,isPending:m,isSuccess:x,error:s}=W(),[p,f]=r.useState(!1),[C,h]=r.useState(!1),[F,u]=r.useState(!1);r.useEffect(()=>{f(!!t[o])},[]),r.useEffect(()=>{x&&(u(!1),f(!p))},[x]);const k=async()=>{t[o]?h(!0):u(!0)},M=async()=>{await A(t,{[o]:!1,solution_description:""})},j=()=>{u(!1)},w=async()=>{b({id:t.id,props:{...a,[o]:!0}})};return e.jsxs(e.Fragment,{children:[e.jsx(P,{open:F,onClose:j,title:"Fixed",children:e.jsxs(n,{sx:{display:"flex",gap:5,flexDirection:"column"},children:[e.jsx(n,{children:e.jsx(g,{value:a.solution_description,onChange:i=>c({...a,solution_description:i.target.value}),sx:{width:"100%"},id:"outlined-basic",label:"Result of repair",error:!!(s!=null&&s.solution_description),helperText:s==null?void 0:s.solution_description,variant:"outlined"})}),e.jsx(n,{children:e.jsx(g,{value:a.price,type:"number",min:0,error:!!(s!=null&&s.price),helperText:s==null?void 0:s.price,onChange:i=>c({...a,price:i.target.value}),sx:{width:"100%"},id:"outlined-basic",label:"Price",variant:"outlined"})}),d.length&&e.jsxs(R,{fullWidth:!0,children:[e.jsx(L,{id:"demo-simple-select-label",children:"Employee"}),e.jsxs(U,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:a.user_id||0,label:"Employee",error:!!(s!=null&&s.user_id),helperText:s==null?void 0:s.user_id,onChange:i=>c({...a,user_id:i.target.value}),children:[e.jsx(v,{disabled:!0,value:0,children:"Set employee"}),d.map((i,$)=>e.jsx(v,{value:i.id,children:i.name},i.id))]})]}),e.jsxs(n,{sx:{display:"flex",gap:3,justifyContent:"space-between"},children:[e.jsx(n,{sx:{display:"flex",gap:3},children:e.jsx(S,{color:"success",disabled:!a.user_id,loading:m,variant:"contained",onClick:w,children:"Save"})}),e.jsx(n,{children:e.jsx(z,{variant:"contained",color:"primary",onClick:j,children:"Cancel"})})]})]})}),e.jsx(I,{title:"Unmarked Picked Up?",open:C,setOpen:h,onConfirm:M,children:"Are you sure? It will be unmarked as picked up."}),e.jsx(S,{loading:m,color:p?"success":"error",size:"small",variant:"text",onClick:k,children:p?e.jsxs(n,{sx:{display:"flex",flexDirection:"column",gap:1,alignItems:"center"},children:[e.jsx(B,{})," ",(y=t.user)==null?void 0:y.name]}):e.jsx(E,{})})]})};export{fe as default};
