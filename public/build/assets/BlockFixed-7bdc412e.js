import{j as e,y as b,r as l}from"./app-76ac79bc.js";import{d as P,a as R}from"./Check-bdf46795.js";import{r as B,i as D}from"./createSvgIcon-8cf6a347.js";import O from"./ConfirmDialog-9e068476.js";import{M as T}from"./Modal-62e9d8e0.js";import{u as q,r as L}from"./repairStore-70936c4f.js";import{u as z}from"./useMutation-9c0fe89b.js";import{B as r}from"./Box-168e7410.js";import{T as C,F as U,I as $,S as A}from"./TextField-9aabd2b7.js";import{M as S}from"./MenuItem-acc128f5.js";import{L as m}from"./LoadingButton-a5642ed6.js";import{B as N}from"./Button-3e190614.js";import"./createSvgIcon-26dc4856.js";import"./createTheme-3079f5c5.js";import"./styled-28cc7788.js";import"./useId-255b287a.js";import"./TransitionGroupContext-6b0cedcb.js";import"./ButtonBase-810d52a6.js";import"./Modal-ec75f9fd.js";import"./Typography-2de56232.js";import"./extendSxProp-09aea199.js";import"./Container-d98a41af.js";import"./styled-65a01fc7.js";import"./vanilla-8854675d.js";import"./Menu-02537618.js";import"./dividerClasses-9af5df81.js";var x={},W=D;Object.defineProperty(x,"__esModule",{value:!0});var F=x.default=void 0,G=W(B()),H=e,J=(0,G.default)((0,H.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Clear");F=x.default=J;const K=async(i,a,n="repairs.update")=>{const d=await axios.patch(route(n,{repair:i.id}),a);return d.status===200&&b.reload({only:["repairs"]}),d},Q=()=>z({mutationFn:async({id:i,props:a})=>{try{const{data:n}=await axios.patch(route("repairs.update.fixed",i),a);return Promise.resolve(n)}catch(n){return Promise.reject(n.response.data.errors)}},onSuccess:()=>{b.reload({only:["repairs"]})}}),Se=({repair:i})=>{var g;const a="is_fixed",d=q(L).employees,[o,p]=l.useState({user_id:0,price:void 0,solution_description:"",is_fixed:0}),{mutate:M,isPending:u,isSuccess:f,error:t}=Q(),[c,h]=l.useState(0),[k,j]=l.useState(!1),[I,v]=l.useState(!1);l.useEffect(()=>{h(i[a])},[i[a],c]),l.useEffect(()=>{f&&h(o[a])},[f]);const w=async()=>{i[a]===0?v(!0):j(!0)},E=async()=>{await K(i,{[a]:!1,solution_description:""})},y=()=>{v(!1)},_=async s=>{M({id:i.id,props:{...o,[a]:s}})};return e.jsxs(e.Fragment,{children:[e.jsx(T,{open:I,onClose:y,title:"Fixed",children:e.jsxs(r,{sx:{display:"flex",gap:5,flexDirection:"column"},children:[e.jsx(r,{children:e.jsx(C,{value:o.solution_description,onChange:s=>p({...o,solution_description:s.target.value}),sx:{width:"100%"},id:"solution_description",label:"Result of repair",error:!!(t!=null&&t.solution_description),helperText:t==null?void 0:t.solution_description,variant:"outlined"})}),e.jsx(r,{children:e.jsx(C,{value:o.price,id:"price",type:"number",min:0,error:!!(t!=null&&t.price),helperText:t==null?void 0:t.price,onChange:s=>p({...o,price:s.target.value}),sx:{width:"100%"},label:"Price",variant:"outlined"})}),d.length&&e.jsxs(U,{fullWidth:!0,children:[e.jsx($,{id:"demo-simple-select-label",children:"Employee"}),e.jsxs(A,{labelId:"employee",id:"employee",value:o.user_id||0,label:"Employee",error:!!(t!=null&&t.user_id),helperText:t==null?void 0:t.user_id,onChange:s=>p({...o,user_id:s.target.value}),children:[e.jsx(S,{disabled:!0,value:0,children:"Set employee"}),d.map((s,V)=>e.jsx(S,{value:s.id,children:s.name},s.id))]})]}),e.jsxs(r,{sx:{display:"flex",gap:3,justifyContent:"space-between"},children:[e.jsxs(r,{sx:{display:"flex",gap:3},children:[e.jsx(m,{color:"success",disabled:!o.user_id,loading:u,variant:"contained",onClick:()=>_(1),children:"Fixed"}),e.jsx(m,{color:"success",disabled:!o.user_id,loading:u,variant:"contained",onClick:()=>_(2),children:"Not fixed"})]}),e.jsx(r,{children:e.jsx(N,{variant:"contained",color:"primary",onClick:y,children:"Cancel"})})]})]})}),e.jsx(O,{title:"Unmarked Picked Up?",open:k,setOpen:j,onConfirm:E,children:"Are you sure? It will be unmarked as picked up."}),e.jsxs(m,{loading:u,color:c?"success":"error",size:"small",variant:"text",onClick:w,children:[c===1&&e.jsxs(r,{sx:{display:"flex",flexDirection:"column",gap:1,alignItems:"center"},children:[e.jsx(P,{})," ",(g=i.user)==null?void 0:g.name]}),c===2&&e.jsx(F,{}),c===0&&e.jsx(R,{})]})]})};export{Se as default};
