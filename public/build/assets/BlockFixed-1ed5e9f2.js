import{y as S,r as l,j as e}from"./app-2228c071.js";import{d as B,a as E}from"./Check-b7a3b9ba.js";import I from"./ConfirmDialog-8b7e1793.js";import{M as P}from"./Modal-8f48e42c.js";import{u as O,r as T}from"./repairStore-b33d4834.js";import{u as D}from"./useMutation-2404ef3d.js";import{B as n}from"./Box-742bb19f.js";import{T as v,F as R,I as L,S as N}from"./TextField-e356d9ab.js";import{M as C}from"./MenuItem-60d10d28.js";import{L as x}from"./LoadingButton-3f6e2ce0.js";import{B as U}from"./Button-73b0cdb9.js";import"./createSvgIcon-15455139.js";import"./createSvgIcon-e2e03bc9.js";import"./createTheme-dcf84243.js";import"./styled-fdc8b611.js";import"./generateUtilityClasses-96161c6c.js";import"./useId-e7280e90.js";import"./TransitionGroupContext-1e4adf20.js";import"./isMuiElement-3d2ef873.js";import"./ButtonBase-d5dccd8f.js";import"./Modal-b8baee57.js";import"./Typography-c3dc3365.js";import"./extendSxProp-a075ea99.js";import"./Container-d8f66ffa.js";import"./styled-f28284cf.js";import"./vanilla-8854675d.js";import"./Menu-00a6b054.js";import"./dividerClasses-1a5564d6.js";const z=async(t,o,r="repairs.update")=>{const d=await axios.patch(route(r,{repair:t.id}),o);return d.status===200&&S.reload({only:["repairs"]}),d},A=()=>D({mutationFn:async({id:t,props:o})=>{try{const{data:r}=await axios.patch(route("repairs.update.fixed",t),o);return Promise.resolve(r)}catch(r){return Promise.reject(r.response.data.errors)}},onSuccess:()=>{S.reload({only:["repairs"]})}}),je=({repair:t})=>{var _;const o="is_fixed",d=O(T).employees,[a,p]=l.useState({user_id:0,price:void 0,solution_description:"",is_fixed:0}),{mutate:b,isPending:u,isSuccess:f,error:s}=A(),[c,h]=l.useState(0),[F,j]=l.useState(!1),[k,m]=l.useState(!1);l.useEffect(()=>{h(t[o])},[t[o],c]),l.useEffect(()=>{f&&(h(a[o]),m(!1))},[f]);const M=async()=>{t[o]===0?m(!0):j(!0)},w=async()=>{await z(t,{[o]:!1,solution_description:""})},y=()=>{m(!1)},g=async i=>{b({id:t.id,props:{...a,[o]:i}})};return e.jsxs(e.Fragment,{children:[e.jsx(P,{open:k,onClose:y,title:"Fixed",children:e.jsxs(n,{sx:{display:"flex",gap:5,flexDirection:"column"},children:[e.jsx(n,{children:e.jsx(v,{value:a.solution_description,onChange:i=>p({...a,solution_description:i.target.value}),sx:{width:"100%"},id:"solution_description",label:"Result of repair",error:!!(s!=null&&s.solution_description),helperText:s==null?void 0:s.solution_description,variant:"outlined"})}),e.jsx(n,{children:e.jsx(v,{value:a.price,id:"price",type:"number",min:0,error:!!(s!=null&&s.price),helperText:s==null?void 0:s.price,onChange:i=>p({...a,price:i.target.value}),sx:{width:"100%"},label:"Price",variant:"outlined"})}),d.length&&e.jsxs(R,{fullWidth:!0,children:[e.jsx(L,{id:"demo-simple-select-label",children:"Employee"}),e.jsxs(N,{labelId:"employee",id:"employee",value:a.user_id||0,label:"Employee",error:!!(s!=null&&s.user_id),helperText:s==null?void 0:s.user_id,onChange:i=>p({...a,user_id:i.target.value}),children:[e.jsx(C,{disabled:!0,value:0,children:"Set employee"}),d.map((i,W)=>e.jsx(C,{value:i.id,children:i.name},i.id))]})]}),e.jsxs(n,{sx:{display:"flex",gap:3,justifyContent:"space-between"},children:[e.jsxs(n,{sx:{display:"flex",gap:3},children:[e.jsx(x,{color:"success",disabled:!a.user_id,loading:u,variant:"contained",onClick:()=>g(1),children:"Fixed"}),e.jsx(x,{color:"success",disabled:!a.user_id,loading:u,variant:"contained",onClick:()=>g(2),children:"Not fixed"})]}),e.jsx(n,{children:e.jsx(U,{variant:"contained",color:"primary",onClick:y,children:"Cancel"})})]})]})}),e.jsx(I,{title:"Unmarked Picked Up?",open:F,setOpen:j,onConfirm:w,children:"Are you sure? It will be unmarked as picked up."}),e.jsxs(x,{loading:u,color:c?"success":"error",size:"small",variant:"text",onClick:M,children:[c===1&&e.jsxs(n,{sx:{display:"flex",flexDirection:"column",gap:1,alignItems:"center"},children:[e.jsx(B,{})," ",(_=t.user)==null?void 0:_.name]}),c===2&&"Not fixed",c===0&&e.jsx(E,{})]})]})};export{je as default};
