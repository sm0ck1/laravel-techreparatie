import{y as b,r as u,j as i}from"./app-a4dd9201.js";import{M as E}from"./Modal-9089ac78.js";import{e as p}from"./editStore-d065645d.js";import r from"./BlockDivider-0db1782c.js";import{u as f,r as I}from"./repairStore-8fd8f1d9.js";import{u as g}from"./useMutation-68a0c94f.js";import P from"./ConfirmDialog-90fcafeb.js";import{T as a,F as M,I as w,S as F}from"./TextField-ceeadb51.js";import{A as B}from"./Autocomplete-84f8189a.js";import{M as R}from"./MenuItem-43dd0aff.js";import{B as N}from"./Box-171afedf.js";import{L as O}from"./LoadingButton-735155e9.js";import{B as j}from"./Button-2c9892a4.js";import"./Modal-dae75802.js";import"./createTheme-2f719790.js";import"./styled-59b188df.js";import"./TransitionGroupContext-c7376866.js";import"./useId-8449ab89.js";import"./Container-a4618aa6.js";import"./styled-b69e3c35.js";import"./Typography-49829012.js";import"./extendSxProp-c01ef0c7.js";import"./vanilla-8854675d.js";import"./ButtonBase-8d136c8e.js";import"./createSvgIcon-ecdeb4f6.js";import"./Menu-83c1f2c4.js";import"./IconButton-73ad78d6.js";import"./dividerClasses-39eef7d0.js";const k=()=>g({mutationFn:async({id:l,props:c})=>{try{const{data:s}=await axios.patch(route("repairs.update",l),c);return Promise.resolve(s)}catch(s){return Promise.reject(s.response.data.errors)}},onSuccess:()=>{b.reload({only:["repairs"]})}}),A=()=>g({mutationFn:async({id:l,props:c})=>{try{const{data:s}=await axios.delete(route("repairs.delete",l),c);return Promise.resolve(s)}catch(s){return Promise.reject(s.response.data.errors)}},onSuccess:()=>{b.reload({only:["repairs"]})}}),ve=()=>{const l=f(p),c=f(I),[s,m]=u.useState(!1),h=c.employees,_=c.groupDevices,[o,n]=u.useState({customer_name:"",customer_phone:"",device:"",problem_description:"",component:"",solution_description:"",price:"",cost:"",invoice:"",note:"",user_id:0}),{mutate:C,isPending:D,error:e,isSuccess:v}=k(),{mutate:S,isPendingDelete:y,errorDelete:L,isSuccess:x}=A();u.useEffect(()=>{(v||x)&&p.clear()},[v,x]),u.useEffect(()=>{if(l.edit&&l.data){const t=[];Object.keys(o).map(d=>{l.data[d]&&(t[d]=l.data[d])}),n(t)}},[l.edit]);const W=async()=>{C({id:l.data.id,props:o})},T=()=>{S({id:l.data.id})};return i.jsxs(i.Fragment,{children:[i.jsxs(E,{open:l.edit,onClose:()=>p.clear(),width:"md",title:`Edit #${l.data.id??0}`,children:[i.jsxs(r,{title:"Customer",children:[i.jsx(a,{value:o.customer_name||"",onChange:t=>n({...o,customer_name:t.target.value}),fullWidth:!0,id:"outlined-basic",label:"Name",error:!!(e!=null&&e.customer_name),helperText:e==null?void 0:e.customer_name,variant:"outlined"}),i.jsx(a,{value:o.customer_phone||"",onChange:t=>n({...o,customer_phone:t.target.value}),fullWidth:!0,id:"outlined-basic",label:"Phone",error:!!(e!=null&&e.customer_phone),helperText:e==null?void 0:e.customer_phone,variant:"outlined"})]}),i.jsxs(r,{title:"Device",children:[i.jsx(B,{id:"free-solo-demo",fullWidth:!0,freeSolo:!0,value:o.device||"",options:_.map(t=>t.device),onInputChange:(t,d)=>{n({...o,device:d})},renderInput:t=>i.jsx(a,{error:!!(e!=null&&e.device),helperText:e==null?void 0:e.device,value:o.device||"",...t,label:"Device"})}),i.jsx(a,{value:o.problem_description||"",onChange:t=>n({...o,problem_description:t.target.value}),fullWidth:!0,id:"outlined-basic",label:"Problem description",error:!!(e!=null&&e.problem_description),helperText:e==null?void 0:e.problem_description,variant:"outlined"})]}),i.jsx(r,{title:"Need to order",other:{flexDirection:"column"},children:i.jsx(a,{value:o.component||"",onChange:t=>n({...o,component:t.target.value}),fullWidth:!0,id:"outlined-basic",label:"Parts",error:!!(e!=null&&e.component),helperText:e==null?void 0:e.component,variant:"outlined"})}),i.jsx(r,{title:"Result of repair",other:{flexDirection:"column"},children:i.jsx(a,{value:o.solution_description||"",onChange:t=>n({...o,solution_description:t.target.value}),fullWidth:!0,id:"outlined-basic",label:"Description",error:!!(e!=null&&e.solution_description),helperText:e==null?void 0:e.solution_description,variant:"outlined"})}),i.jsxs(r,{title:"Invoice",children:[i.jsx(a,{value:o.price||"",onChange:t=>n({...o,price:t.target.value}),fullWidth:!0,id:"outlined-basic",label:"Price",error:!!(e!=null&&e.price),helperText:e==null?void 0:e.price,variant:"outlined"}),i.jsx(a,{value:o.cost||"",onChange:t=>n({...o,cost:t.target.value}),fullWidth:!0,id:"outlined-basic",label:"Cost",error:!!(e!=null&&e.cost),helperText:e==null?void 0:e.cost,variant:"outlined"}),i.jsx(a,{value:o.invoice||"",onChange:t=>n({...o,invoice:t.target.value}),fullWidth:!0,id:"outlined-basic",label:"Invoice",error:!!(e!=null&&e.invoice),helperText:e==null?void 0:e.invoice,variant:"outlined"})]}),h.length&&i.jsx(r,{title:"Employeer",children:i.jsxs(M,{fullWidth:!0,children:[i.jsx(w,{id:"demo-simple-select-label",children:"Employee"}),i.jsx(F,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:o.user_id||"",label:"Employee",onChange:t=>n({...o,user_id:t.target.value}),children:h.map(t=>i.jsx(R,{value:t.id,children:t.name},t.id))})]})}),i.jsx(r,{title:"Note",children:i.jsx(a,{value:o.note||"",onChange:t=>n({...o,note:t.target.value}),fullWidth:!0,id:"outlined-basic",label:"Note",error:!!(e!=null&&e.note),helperText:e==null?void 0:e.note,variant:"outlined"})}),i.jsxs(N,{sx:{display:"flex",gap:5,flexDirection:"row"},children:[i.jsx(O,{fullWidth:!0,size:"large",color:"success",loading:D,variant:"contained",onClick:W,children:"Save"}),i.jsx(j,{fullWidth:!0,variant:"contained",onClick:p.clear,children:"Cancel"}),i.jsx(j,{fullWidth:!0,variant:"contained",color:"error",onClick:()=>m(!0),loading:y,children:"Delete"})]})]}),i.jsx(P,{title:"It will be delete",open:s,setOpen:m,onConfirm:T,children:"Are you sure? It will be delete."})]})};export{ve as default};
