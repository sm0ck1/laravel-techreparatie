import{y as g,r as d,j as i}from"./app-beddce8b.js";import{M as E}from"./Modal-9f9f1533.js";import{e as p}from"./editStore-d065645d.js";import r from"./BlockDivider-64c23951.js";import{u as f,r as I}from"./repairStore-2e9502da.js";import{u as j}from"./useMutation-faa736ed.js";import P from"./ConfirmDialog-8db62301.js";import{T as n,F as M,I as w,S as F}from"./TextField-902c9dec.js";import{A as B}from"./Autocomplete-3f50d121.js";import{M as R}from"./MenuItem-20cd287a.js";import{B as N}from"./Box-2a0e5537.js";import{L as O}from"./LoadingButton-2e26c576.js";import{B as b}from"./Button-6a927bec.js";import"./Modal-c513949b.js";import"./createTheme-f32bee78.js";import"./styled-fe7b6d34.js";import"./generateUtilityClasses-8dbd3f78.js";import"./TransitionGroupContext-b3f37442.js";import"./useId-7308d492.js";import"./Container-4316c3cb.js";import"./styled-33f14086.js";import"./Typography-4ce1f746.js";import"./extendSxProp-83c8076c.js";import"./vanilla-8854675d.js";import"./ButtonBase-99b1f067.js";import"./isMuiElement-06c39a81.js";import"./Menu-fd17e589.js";import"./createSvgIcon-9d9eb473.js";import"./IconButton-97952f0f.js";import"./dividerClasses-3480dc65.js";const k=()=>j({mutationFn:async({id:l,props:c})=>{try{const{data:s}=await axios.patch(route("repairs.update",l),c);return Promise.resolve(s)}catch(s){return Promise.reject(s.response.data.errors)}},onSuccess:()=>{g.reload({only:["repairs"]})}}),A=()=>j({mutationFn:async({id:l,props:c})=>{try{const{data:s}=await axios.delete(route("repairs.delete",l),c);return Promise.resolve(s)}catch(s){return Promise.reject(s.response.data.errors)}},onSuccess:()=>{g.reload({only:["repairs"]})}}),fe=()=>{const l=f(p),c=f(I),[s,m]=d.useState(!1),h=c.employees,_=c.groupDevices,[o,a]=d.useState({customer_name:"",customer_phone:"",customer_email:"",device:"",problem_description:"",component:"",solution_description:"",price:"",cost:"",invoice:"",note:"",user_id:0}),{mutate:C,isPending:D,error:e,isSuccess:v}=k(),{mutate:S,isPendingDelete:y,errorDelete:L,isSuccess:x}=A();d.useEffect(()=>{(v||x)&&p.clear()},[v,x]),d.useEffect(()=>{if(l.edit&&l.data){const t=[];Object.keys(o).map(u=>{l.data[u]&&(t[u]=l.data[u])}),a(t)}},[l.edit]);const W=async()=>{C({id:l.data.id,props:o})},T=()=>{S({id:l.data.id})};return i.jsxs(i.Fragment,{children:[i.jsxs(E,{open:l.edit,onClose:()=>p.clear(),width:"md",title:`Edit #${l.data.id??0}`,children:[i.jsxs(r,{title:"Customer",children:[i.jsx(n,{value:o.customer_name||"",onChange:t=>a({...o,customer_name:t.target.value}),fullWidth:!0,id:"outlined-basic",label:"Name",error:!!(e!=null&&e.customer_name),helperText:e==null?void 0:e.customer_name,variant:"outlined"}),i.jsx(n,{value:o.customer_phone||"",onChange:t=>a({...o,customer_phone:t.target.value}),fullWidth:!0,id:"outlined-basic",label:"Phone",error:!!(e!=null&&e.customer_phone),helperText:e==null?void 0:e.customer_phone,variant:"outlined"}),i.jsx(n,{value:o.customer_email||"",onChange:t=>a({...o,customer_email:t.target.value}),fullWidth:!0,id:"outlined-basic",label:"Email",error:!!(e!=null&&e.customer_email),helperText:e==null?void 0:e.customer_email,variant:"outlined"})]}),i.jsxs(r,{title:"Device",children:[i.jsx(B,{id:"free-solo-demo",fullWidth:!0,freeSolo:!0,value:o.device||"",options:_.map(t=>t.device),onInputChange:(t,u)=>{a({...o,device:u})},renderInput:t=>i.jsx(n,{error:!!(e!=null&&e.device),helperText:e==null?void 0:e.device,value:o.device||"",...t,label:"Device"})}),i.jsx(n,{value:o.problem_description||"",onChange:t=>a({...o,problem_description:t.target.value}),fullWidth:!0,id:"outlined-basic",label:"Problem description",error:!!(e!=null&&e.problem_description),helperText:e==null?void 0:e.problem_description,variant:"outlined"})]}),i.jsx(r,{title:"Need to order",other:{flexDirection:"column"},children:i.jsx(n,{value:o.component||"",onChange:t=>a({...o,component:t.target.value}),fullWidth:!0,id:"outlined-basic",label:"Parts",error:!!(e!=null&&e.component),helperText:e==null?void 0:e.component,variant:"outlined"})}),i.jsx(r,{title:"Result of repair",other:{flexDirection:"column"},children:i.jsx(n,{value:o.solution_description||"",onChange:t=>a({...o,solution_description:t.target.value}),fullWidth:!0,id:"outlined-basic",label:"Description",error:!!(e!=null&&e.solution_description),helperText:e==null?void 0:e.solution_description,variant:"outlined"})}),i.jsxs(r,{title:"Invoice",children:[i.jsx(n,{value:o.price||"",onChange:t=>a({...o,price:t.target.value}),fullWidth:!0,id:"outlined-basic",label:"Price",error:!!(e!=null&&e.price),helperText:e==null?void 0:e.price,variant:"outlined"}),i.jsx(n,{value:o.cost||"",onChange:t=>a({...o,cost:t.target.value}),fullWidth:!0,id:"outlined-basic",label:"Cost",error:!!(e!=null&&e.cost),helperText:e==null?void 0:e.cost,variant:"outlined"}),i.jsx(n,{value:o.invoice||"",onChange:t=>a({...o,invoice:t.target.value}),fullWidth:!0,id:"outlined-basic",label:"Invoice",error:!!(e!=null&&e.invoice),helperText:e==null?void 0:e.invoice,variant:"outlined"})]}),h.length&&i.jsx(r,{title:"Employeer",children:i.jsxs(M,{fullWidth:!0,children:[i.jsx(w,{id:"demo-simple-select-label",children:"Employee"}),i.jsx(F,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:o.user_id||"",label:"Employee",onChange:t=>a({...o,user_id:t.target.value}),children:h.map(t=>i.jsx(R,{value:t.id,children:t.name},t.id))})]})}),i.jsx(r,{title:"Note",children:i.jsx(n,{value:o.note||"",onChange:t=>a({...o,note:t.target.value}),fullWidth:!0,id:"outlined-basic",label:"Note",error:!!(e!=null&&e.note),helperText:e==null?void 0:e.note,variant:"outlined"})}),i.jsxs(N,{sx:{display:"flex",gap:5,flexDirection:"row"},children:[i.jsx(O,{fullWidth:!0,size:"large",color:"success",loading:D,variant:"contained",onClick:W,children:"Save"}),i.jsx(b,{fullWidth:!0,variant:"contained",onClick:p.clear,children:"Cancel"}),i.jsx(b,{fullWidth:!0,variant:"contained",color:"error",onClick:()=>m(!0),loading:y,children:"Delete"})]})]}),i.jsx(P,{title:"It will be delete",open:s,setOpen:m,onConfirm:T,children:"Are you sure? It will be delete."})]})};export{fe as default};
