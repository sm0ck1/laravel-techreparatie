import{y as B,r as l,j as e}from"./app-5bcc3c4e.js";import{d as W,a as v}from"./Check-24bc75d0.js";import{M as D}from"./Modal-64fc0500.js";import E from"./ConfirmDialog-1aaed424.js";import{u as P,r as A}from"./repairStore-449de957.js";import{d as L}from"./LocalShipping-6f360248.js";import{u as R}from"./useMutation-b93fe0f8.js";import{B as d}from"./Box-a66e3e67.js";import{T as m,F as U,I as $,S as z}from"./TextField-c14dc086.js";import{A as N}from"./Autocomplete-19599d0c.js";import{M as w}from"./MenuItem-dc52efc5.js";import{L as b}from"./LoadingButton-e9ff529f.js";import{B as q}from"./Button-63c11eb4.js";import"./createSvgIcon-611f6527.js";import"./createSvgIcon-25075ad9.js";import"./createTheme-19cca19d.js";import"./styled-b1675e46.js";import"./useId-c997680d.js";import"./TransitionGroupContext-9ce3b4fa.js";import"./ButtonBase-1bd522b4.js";import"./Modal-4e9420e0.js";import"./Container-03904695.js";import"./styled-a4b60c95.js";import"./Typography-0a4d646b.js";import"./extendSxProp-d9f24618.js";import"./vanilla-8854675d.js";import"./Menu-3d6ba574.js";import"./IconButton-a7712fa5.js";import"./Popper-16eab091.js";import"./dividerClasses-ea92cc86.js";const G=()=>R({mutationFn:async({id:s,props:n})=>{try{const{data:i}=await axios.patch(route("repairs.update.ordered",s),n);return Promise.resolve(i)}catch(i){return Promise.reject(i.response.data.errors)}},onSuccess:()=>{B.reload({only:["repairs"]})}}),we=({repair:s})=>{const n="is_ordered_component",i=P(A),p=i.employees,S=i.groupWhereOrdered,[C,u]=l.useState(!1),[k,h]=l.useState(!1),[O,c]=l.useState(!1),[r,a]=l.useState({who_ordered_id:0,component:"",is_ordered_component:!1,cost:void 0,where_ordered:""}),{mutate:x,isPending:f,error:o,isSuccess:_}=G();l.useEffect(()=>{u(!!s[n])},[]),l.useEffect(()=>{_&&(c(!1),u(!C))},[_]);const M=async t=>{s[n]?h(!0):c(!0)},F=async()=>{x({id:s.id,props:{[n]:!1,who_ordered_id:0,component:"",cost:0,is_ordered_component:!1}})},j=()=>{c(!1)},I=async()=>{x({id:s.id,props:{...r,[n]:!0}})},g=()=>s.is_fixed&&s.who_ordered_id>0?1:s.who_ordered_id>0&&s.is_ordered_component&&!s.is_fixed?2:s.is_fixed&&!s.who_ordered_id?3:4,T=()=>{const t=g();return t===1?e.jsx(d,{sx:{display:"flex",flexDirection:"column",gap:1,alignItems:"center"},children:e.jsx(W,{})}):t===2?e.jsxs(d,{"aria-describedby":"block-ordered-status-open-popover",sx:{display:"flex",flexDirection:"column",gap:1,alignItems:"center"},children:[e.jsx(L,{}),s.date_ordered]}):t===3?e.jsx(e.Fragment,{children:e.jsx(v,{})}):e.jsx(v,{})};return e.jsxs(e.Fragment,{children:[e.jsx(D,{open:O,onClose:j,title:"Ordered",children:e.jsxs(d,{sx:{display:"flex",gap:5,flexDirection:"column"},children:[e.jsx(d,{children:e.jsx(m,{value:r.component||"",onChange:t=>a({...r,component:t.target.value}),sx:{width:"100%"},id:"outlined-basic",label:"Need to order",error:!!(o!=null&&o.component),helperText:o==null?void 0:o.component,variant:"outlined"})}),e.jsx(d,{children:e.jsx(m,{value:r.cost||"",type:"number",min:0,onChange:t=>a({...r,cost:t.target.value}),sx:{width:"100%"},id:"outlined-basic",label:"Cost",error:!!(o!=null&&o.cost),helperText:o==null?void 0:o.cost,variant:"outlined"})}),e.jsx(d,{children:e.jsx(N,{id:"free-solo-demo",freeSolo:!0,options:S.map(t=>t.where_ordered),renderInput:t=>e.jsx(m,{error:!!(o!=null&&o.where_ordered),helperText:o==null?void 0:o.where_ordered,value:r.where_ordered||"",onChange:y=>a({...r,where_ordered:y.target.value}),...t,label:"Where ordered"})})}),p.length&&e.jsxs(U,{fullWidth:!0,children:[e.jsx($,{id:"demo-simple-select-label",children:"Who ordered?"}),e.jsxs(z,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:r.who_ordered_id||0,label:"Who ordered?",error:!!(o!=null&&o.who_ordered_id),helperText:o==null?void 0:o.who_ordered_id,onChange:t=>a({...r,who_ordered_id:t.target.value}),children:[e.jsx(w,{disabled:!0,value:0,children:"Set employee"}),p.map((t,y)=>e.jsx(w,{value:t.id,children:t.name},t.id))]})]}),e.jsxs(d,{sx:{display:"flex",gap:3,justifyContent:"space-between"},children:[e.jsx(d,{sx:{display:"flex",gap:3},children:e.jsx(b,{color:"success",disabled:!r.who_ordered_id,loading:f,variant:"contained",onClick:I,children:"Save"})}),e.jsx(d,{children:e.jsx(q,{variant:"contained",color:"primary",onClick:j,children:"Cancel"})})]})]})}),e.jsx(E,{title:"Unmarked Picked Up?",open:k,setOpen:h,onConfirm:F,children:"Are you sure? It will be unmarked as picked up."}),e.jsx(b,{loading:f,color:g()!==4?"success":"error",size:"small",variant:"text",onClick:M,children:T()})]})};export{we as default};
